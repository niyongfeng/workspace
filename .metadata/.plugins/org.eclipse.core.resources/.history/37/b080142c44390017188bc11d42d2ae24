<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8" import="java.util.*,com.nyf.pojo.*"%>
<%
	List list = (List) request.getAttribute("list");
%>
<%
	List list1 = (List) request.getSession().getAttribute("list1");
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico"> -->

<title>轻课商城</title>

<!-- Bootstrap core CSS -->
<link
	href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"
	rel="stylesheet">

<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<link href="../../assets/css/ie10-viewport-bug-workaround.css"
	rel="stylesheet">

<!-- Custom styles for this template -->
<link href="navbar.css" rel="stylesheet">

<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
<!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
<script src="../../assets/js/ie-emulation-modes-warning.js"></script>
<script src="javascripts/jquery-1.9.0.min.js" type="text/javascript"></script>

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]-->
      <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <!--[endif]-->
</head>

<body>

	<div class="container">

		<!-- Static navbar -->
		<nav class="navbar navbar-default">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed"
					data-toggle="collapse" data-target="#navbar" aria-expanded="false"
					aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">轻课商城</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="#">首页</a></li>
					<li><a href="#">热销商品</a></li>
					<li><a href="#">热门活动</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li><a href="./">个人中心 <span class="sr-only">(current)</span></a></li>
					<li><a href="../navbar-static-top/">购物车</a></li>
					<li><a href="ExitServlet">退出</a></li>
				</ul>
			</div>
			<!--/.nav-collapse -->
		</div>
		<!--/.container-fluid --> </nav>

		<!-- Main component for a primary marketing message or call to action -->
		<div class="jumbotron">
			<h3>热门商品</h3>
			<p>不要998！不要998！只要99！只要99</p>
		</div>
		<label>我的购物车：</label>
		<div id = "cart"></div>
		<hr/>
		<div class="row">
			<div class="col-sm-6 col-md-4">
				<form class="form-inline" action="SearchServlet" method="get">
					<div class="form-group">
						<input type="text" name="searchKey" class="form-control"
							id="searchKey" placeholder="搜搜看"> <select id="tag_id"
							name="tag_id" class="form-control input-sm">
							<%
								for (Object ob : list1) {
									Tag tag = (Tag) ob;
							%>
							<option value="<%=tag.getId()%>"><%=tag.getName()%></option>
							<%
								}
							%>
						</select>
						<button type="submit" class="btn btn-default">搜一下</button>
					</div>
				</form>
			</div>
			<div class="btn-group">
				<button class="btn btn-default btn-sm dropdown-toggle" type="button"
					data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					管理员操作<span class="caret"></span>
				</button>
				<ul class="dropdown-menu" >
				<li class="active"><a href="add.jsp">添加商品<span class="sr-only"></span></a></li>
				</ul>
			</div>
		</div>
		<hr />
		<div class="row">
			<%
				if (list.size() == 0) {
			%>
			<p style="text-align: center">搜索无结果！</p>
			<%
				}
			%>
			<%
				for (Object ob : list) {
					Product product = (Product) ob;
			%>
			<div class="col-sm-6 col-md-4">
				<div class="thumbnail">
					<img src="<%=product.getPicture()%>" alt="...">
					<div class="caption">
						<h3 style="text-align: center"><%=product.getTitle()%></h3>
						<p id = "price" style="text-align: center">
							价格：<%=product.getPrice()%>&nbsp;&nbsp;&nbsp;数量：<%=product.getNumber()%></p>
						<p style="text-align: center">
							<a href="AddServlet?id=<%=product.getId()%>" class="btn btn-primary" role="button">修改商品</a>&nbsp;&nbsp;
							<a href="DeleteServlet?id=<%=product.getId()%>" class="btn btn-default" role="button">删除商品</a><br/><br/>
							<a href="#" class="btn btn-default addCart" role="button">添加购物车</a>
						</p>
					</div>
				</div>
			</div>
			<%
				}
			%>
		</div>
	</div>
	<script type="text/javascript">
		$(".addCart").click(function (){
			alert("添加到购物车");
			var parent = $(this).parents(".thumbnail");
			console.log(parent);
			var children = parent.children("div");
			var title = children.children("h3").text();
			var priceAndNumber = children.children("#price").text();
			var price = priceAndNumber.substring(priceAndNumber.indexOf("：") + 1,priceAndNumber.indexOf("数量"));
			alert(price);
			var number = 1;
			var str = "<tr><td>" + title + "&nbsp;&nbsp;</td><td>" + number + "&nbsp;&nbsp;</td><td>" + price +"</td></tr>";
			$("#cart").prepend(str);
		});
	</script>
	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<!-- 	<script>
		window.jQuery
				|| document
						.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')
	</script> -->
	<script
		src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
	<script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>


</body>
</html>